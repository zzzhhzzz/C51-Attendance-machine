/*************************************************************
                      单片机中断头文件

实现功能：单片机定时2

***************************************************************/
#ifndef _T2_H_
#define _T2_H_
#include<reg52.h>

#define uchar unsigned char
#define uint unsigned int
#define ulong unsigned long
sfr T2MOD = 0xC9;
/**************************变量定义****************************/
uint T2_num=0;            //定时器2计数变量
/************************引脚定义************************/
sbit jdq=P3^6;  //继电器（控制电磁锁）
/*********************************************************
函数void T2_init()
定时器2初始化函数
*********************************************************/
void T2_init()
{
	RCAP2H=(65536-50000)/256; 
	RCAP2L=(65536-50000)%256;//自动重装 
	TH2=RCAP2H; 
	TL2=RCAP2L;              //定时器2赋初值 
	EA=1;                    //开总中断
	ET2=1;                   //定时器T2中断允许      
	TR2=0;				     //关闭定时器2
}
/*********************************************************
函void T2_interrupt(void) interrupt 5
定时器2中断处理函数
定时50MS中断一次
*********************************************************/
void T2_interrupt(void) interrupt 5
{
	TF2=0; //清除定时器2溢出标志位
	 
	T2_num++;	   //计数变量+1
	if(T2_num==200)//200*50ms=10S定时完成
	{
		T2_num=0;  //清0计数变量
		jdq=1;	   //关闭继电器，电磁锁关闭
		TR2=0;	   //定时器关闭
	} 
}
#endif